---
layout: post
---
I present to you the chronicle of my troubleshooting for the weekend challenge, Instagram clone in Ruby on Rails using Rspec for testing.  Warning: This is a 'no such thing as stupid questions' zone!

<!--more-->

I've decided to start my testing/coding with uploading an aimage description first and because of how I wrote my test 
1- I had to remind myself of how to make button text in erb.

```ruby
scenario 'prompts user to enter a description, then displays the new description' do
  visit '/images'
  click_link 'Upload Image'
  fill_in 'Description', with: 'My face'
  click_button 'Upload'
  expect(page).to have_content 'My face'
  expect(current_path).to eq '/images'
end
```  
```
<%= form_for Image.new do |i| %>
  <%= i.label :description %>
  <%= i.text_field :description %>
  <%= i.submit "Upload" %>
<% end %>
```

2- Hit a snag navigating my routes for what happens after a user comments, the key was redirecting back to the image's path, passing the id as a param  
```
scenario 'allows users to comment on an image' do
  visit '/images'
  click_link 'Comment on My face'
  fill_in "Comment", with: "so so"
  click_button 'Comment'
  expect(page).to have_content('so so')
end
```  
```
def new
  @image = Image.find(params[:image_id])
  @comment = Comment.new
end

def create
  @image = Image.find(params[:image_id])
  @image.comments.create(comment_params)
  redirect_to image_path(@image)
end
```

Undoing database migrations.... Ok I knew it would come to this.  So I messed up while generating a new migration but the revert wasn't so painful.  
First to get the last working migration's ID.  
```
bin/rake db:migrate:status
```  
Then  
```
bin/rake db:migrate VERSION="###"
bin/rake db:migrate
```  
[Source](http://stackoverflow.com/questions/3872586/how-to-delete-migration-files-in-rails-3) Then the shenanigans can carry on.
